include_directories( SYSTEM ${Boost_INCLUDE_DIRS} )

add_executable( assembly assembly.cpp )
add_executable( stiffness stiffness.cpp )
add_executable( mass mass.cpp )
add_executable( mass_IGA mass_IGA.cpp )
add_executable( dg_flux dg_flux.cpp )
set_target_properties( assembly PROPERTIES COMPILE_FLAGS ${ADDITIONAL_CXX_FLAGS} )
set_target_properties( stiffness PROPERTIES COMPILE_FLAGS ${ADDITIONAL_CXX_FLAGS} )
set_target_properties( mass PROPERTIES COMPILE_FLAGS ${ADDITIONAL_CXX_FLAGS} )
set_target_properties( mass_IGA PROPERTIES COMPILE_FLAGS ${ADDITIONAL_CXX_FLAGS} )
set_target_properties( dg_flux PROPERTIES COMPILE_FLAGS ${ADDITIONAL_CXX_FLAGS} )

set( ENABLE_INTREPID "OFF" CACHE BOOL "Enable support of finite elements discretization from the Intrepid library" )
if(ENABLE_INTREPID)
  if(NOT INTREPID_SOURCE_DIR)
    message("set the INTREPID_SOURCE_DIR to point to the intrepid sources")
  else()
    include_directories( SYSTEM ${INTREPID_SOURCE_DIR} )
  endif(NOT INTREPID_SOURCE_DIR)
  if(NOT INTREPID_LIB_DIR)
    message("set the INTREPID_LIB_DIR to point to the intrepid libraries")
  else()
    find_library( INTREPID_LIB intrepid ${INTREPID_LIB_DIR})
    message("intrepid found in " ${INTREPID_LIB})
    find_library( KOKKOS_LIB kokkoscore ${INTREPID_LIB_DIR})
    message("kokkos found in " ${KOKKOS_LIB})
    find_library( TEUCHOS_LIB teuchoscore ${INTREPID_LIB_DIR})
    message("teuchos found in " ${TEUCHOS_LIB})
    find_library( TEUCHOS_NUMERICS_LIB teuchosnumerics ${INTREPID_LIB_DIR})
    message("teuchos numerics found in " ${TEUCHOS_NUMERICS_LIB})
    find_library( SHARDS_LIB shards ${INTREPID_LIB_DIR})
    message("shards found in " ${SHARDS_LIB})

    if(BLAS_DIR)
          set(CMAKE_LIBRARY_PATH ${CMAKE_LIBRARY_PATH} ${BLAS_DIR})
    endif(BLAS_DIR)

    if(LAPACK_DIR)
          set(CMAKE_LIBRARY_PATH ${CMAKE_LIBRARY_PATH} ${LAPACK_DIR})
    endif(LAPACK_DIR)

    find_package(BLAS REQUIRED)
    if(NOT BLAS_FOUND)
           message("BLAS library not found. Set the path to the installation via the BLAS_DIR CMake variable.")
    endif(NOT BLAS_FOUND)

    find_package(LAPACK REQUIRED)
    if(NOT LAPACK_FOUND)
           message("Lapack library not found. Set the path to the installation via the LAPACK_DIR CMake variable.")
    endif(NOT LAPACK_FOUND)

 endif(NOT INTREPID_LIB_DIR)
endif(ENABLE_INTREPID)

target_link_libraries( assembly ${exe_LIBS} gcl ${MPI_ADDITIONAL_LIBS}  ${INTREPID_LIB} ${TEUCHOS_LIB} ${SHARDS_LIB} )
target_link_libraries( stiffness ${exe_LIBS} gcl ${MPI_ADDITIONAL_LIBS}  ${INTREPID_LIB} ${TEUCHOS_LIB} ${TEUCHOS_NUMERICS_LIB} ${LAPACK_LIBRARIES} ${SHARDS_LIB} )
target_link_libraries( mass ${exe_LIBS} gcl ${MPI_ADDITIONAL_LIBS}  ${INTREPID_LIB} ${TEUCHOS_LIB} ${SHARDS_LIB} )
target_link_libraries( mass_IGA ${exe_LIBS} gcl ${MPI_ADDITIONAL_LIBS}  ${INTREPID_LIB} ${TEUCHOS_LIB} ${SHARDS_LIB} )
target_link_libraries( dg_flux ${exe_LIBS} gcl ${MPI_ADDITIONAL_LIBS}  ${INTREPID_LIB} ${TEUCHOS_LIB} ${TEUCHOS_NUMERICS_LIB} ${LAPACK_LIBRARIES} ${SHARDS_LIB} )

cuda_add_executable( mass_IGA_cuda mass_IGA.cu )
target_link_libraries(mass_IGA_cuda ${exe_LIBS} gcl ${MPI_ADDITIONAL_LIBS} ${INTREPID_LIB} ${TEUCHOS_LIB} ${SHARDS_LIB})


add_subdirectory( IGA )
add_subdirectory( doc )
