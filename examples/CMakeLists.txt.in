# This file drives compilation of all examples and is installed together with the example sources.
cmake_minimum_required(VERSION 3.12.4)

project(GridTools-examples CXX)

include(ExternalProject)

enable_testing()

if(@COMPONENT_STENCIL_COMPOSITION@)
    ExternalProject_Add(stencil-composition-example
        DOWNLOAD_COMMAND ""
        SOURCE_DIR ${CMAKE_CURRENT_LIST_DIR}/stencil-composition
        CMAKE_ARGS -DGridTools_DIR=${CMAKE_CURRENT_LIST_DIR}/../lib/cmake
        INSTALL_COMMAND ""
        )
    ExternalProject_Get_property(stencil-composition-example BINARY_DIR)
    add_test(NAME stencil-composition-example COMMAND ctest WORKING_DIRECTORY ${BINARY_DIR})
endif()

if(@COMPONENT_BOUNDARY_CONDITIONS@)
    ExternalProject_Add(boundary-conditions-example
        DOWNLOAD_COMMAND ""
        SOURCE_DIR ${CMAKE_CURRENT_LIST_DIR}/boundary-conditions
        CMAKE_ARGS -DGridTools_DIR=${CMAKE_CURRENT_LIST_DIR}/../lib/cmake
        INSTALL_COMMAND ""
        )
    ExternalProject_Get_property(boundary-conditions-example BINARY_DIR)
    add_test(NAME boundary-conditions-example COMMAND ctest WORKING_DIRECTORY ${BINARY_DIR})
endif()
    