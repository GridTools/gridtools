# This file drives compilation of all examples and is installed together with the example sources.
cmake_minimum_required(VERSION 3.12.4)

project(GridTools-examples CXX)

include(ExternalProject)

enable_testing()

foreach(ex IN ITEMS @enabled_examples@)
    ExternalProject_Add(${ex}-example
        DOWNLOAD_COMMAND ""
        SOURCE_DIR ${CMAKE_CURRENT_LIST_DIR}/${ex}
        CMAKE_ARGS -DGridTools_DIR=@CMAKE_INSTALL_PREFIX@/lib/cmake
        INSTALL_COMMAND ""
        )
    ExternalProject_Get_property(${ex}-example BINARY_DIR)
    add_test(NAME ${ex}-example COMMAND ctest WORKING_DIRECTORY ${BINARY_DIR})
endforeach()
    